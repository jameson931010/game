<!DOCTYPE html>
<html lang='en'>
<head>
    <meta charset='UTF-8'>
    <title>game</title>
</head>
<body>
    <div id='graph'>
        <p>0 0 0 0 0 0</p>
        <p>0 0 0 0 0 0</p>
        <p>0 0 0 0 0 0</p>
        <p>0 0 0 0 0 0</p>
        <p>0 0 0 0 0 0</p>
        <p>0 0 0 0 0 0</p>
    </div>
    <script>
    var endgame = false;
    var space = 36, bomb = 0;
    var graph = [
        [-1, -1, -1, -1, -1, -1, -1, -1],
        [-1, 0, 0, 0, 0, 0, 0, -1],
        [-1, 0, 0, 0, 0, 0, 0, -1],
        [-1, 0, 0, 0, 0, 0, 0, -1],
        [-1, 0, 0, 0, 0, 0, 0, -1],
        [-1, 0, 0, 0, 0, 0, 0, -1],
        [-1, 0, 0, 0, 0, 0, 0, -1],
        [-1, -1, -1, -1, -1, -1, -1, -1]
    ];
    var checkqueue=[];
    var checked=[];
    function lose() {
        alert("you lose!!");
    }
    function count(row, column) {
        checked.push([row, column]);
        var dx = [0, 0, 1, -1];
        var dy = [1, -1, 0, 0];
        var cnt = 0;
        for(var i=0; i<4; i++){
            var nx = row+dx[i], ny = column+dy[i];
            if(graph[nx][ny] == -1) {
                cnt++;
                checked.push([nx, ny]);
            }
            else if(!(checkqueue.includes([nx, ny]) || checked.includes([nx, ny]))) {
                console.log(checkqueue);
                checkqueue.push([nx, ny]);
            }
        }
        graph[row][column] = cnt;
        return cnt;
    }
    function check(row, column, dir) {
        if(dir == -1 && graph[row][column] == -1) {
            lose();
            return;
        }
        else {
            var cnt = count(row, column);
            graph[row][column] = cnt;
            while(checkqueue.length >= 0) {
                var index = checkqueue.pop();
                console.log(index[0], index[1]);
                check(index[0], index[1], 0);
            }
        }
    }

    function create() {
        while(bomb < 4) {
            var br = Math.floor(Math.random()*6);
            var bc = Math.floor(Math.random()*6);
            if(graph[br+1][bc+1] == 0) {
                bomb++;
                graph[br+1][bc+1] = -1;
            }
        }
    }
    create();
    console.log(graph);
    while(!endgame) {
        var input=prompt("please enter row and colomn number");
        index=input.split(" ");
        row = parseInt(index[0])+1;
        column = parseInt(index[1])+1;
        check(row, column, -1);
        var output = document.getElementById("graph");
        output = `
        <div>
            <p>${graph[1]}</p>
            <p>${graph[2]}</p>
            <p>${graph[3]}</p>
            <p>${graph[4]}</p>
            <p>${graph[5]}</p>
            <p>${graph[6]}</p>
        </div>;
        `
    }

    </script> 
    <script src="./play.js" />
</body>
